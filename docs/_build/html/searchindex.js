Search.setIndex({"docnames": ["_autosummary/nmf_models", "_autosummary/nmf_models.nmf_models_mod_updates", "_autosummary/nmf_models.nmf_models_mod_updates.InvalidMatType", "_autosummary/nmf_models.nmf_models_mod_updates.intNMF", "_autosummary/nmf_models.nmf_models_mod_updates.log_tf_idf", "_autosummary/nmf_models.plotting", "api", "index", "notebooks/example_nmf", "notebooks/h5ad_example", "notebooks/intNMF_example", "readme", "tutorials", "usage"], "filenames": ["_autosummary/nmf_models.rst", "_autosummary/nmf_models.nmf_models_mod_updates.rst", "_autosummary/nmf_models.nmf_models_mod_updates.InvalidMatType.rst", "_autosummary/nmf_models.nmf_models_mod_updates.intNMF.rst", "_autosummary/nmf_models.nmf_models_mod_updates.log_tf_idf.rst", "_autosummary/nmf_models.plotting.rst", "api.rst", "index.rst", "notebooks/example_nmf.ipynb", "notebooks/h5ad_example.ipynb", "notebooks/intNMF_example.ipynb", "readme.rst", "tutorials.rst", "usage.rst"], "titles": ["nmf_models", "nmf_models.nmf_models_mod_updates", "nmf_models.nmf_models_mod_updates.InvalidMatType", "nmf_models.nmf_models_mod_updates.intNMF", "nmf_models.nmf_models_mod_updates.log_tf_idf", "nmf_models.plotting", "&lt;no title&gt;", "Welcome to sc_intNMF\u2019s documentation!", "intNMF examples", "&lt;no title&gt;", "intNMF example", "README", "Tutorials", "Usage"], "terms": {"modul": 1, "contain": [1, 7, 8], "innmf": 1, "class": [1, 3, 8, 13], "tf": [1, 4], "idf": [1, 4], "function": [1, 8, 10, 13], "except": [1, 2], "sourc": [2, 3, 4], "rais": [2, 4], "mat": [2, 4, 8], "i": [2, 3, 4, 7, 8, 10, 13], "invalid": [2, 4], "n_topic": 3, "epoch": [3, 8], "15": [3, 8, 10], "init": [3, 8], "random": [3, 8], "mod1_skew": 3, "0": [3, 8, 10], "5": [3, 8, 10, 13], "reg": 3, "none": [3, 8, 10], "seed": 3, "base": [3, 13], "object": [3, 8, 10, 13], "run": [3, 10, 13], "int": [3, 4], "nmf": [3, 10, 12, 13], "multiom": [3, 7, 8, 10, 13], "data": [3, 7, 10, 12], "theta": [3, 8, 10, 13], "cell": [3, 4, 7, 8, 10, 13], "x": [3, 4, 8, 10], "topic": [3, 12, 13], "matrix": [3, 4, 7, 8], "joint": [3, 7, 13], "low": [3, 13], "dimension": [3, 13], "embed": [3, 7, 8, 13], "type": [3, 4, 8, 10], "arrai": [3, 8], "like": 3, "phi_rna": [3, 8, 10, 13], "gene": [3, 7, 8], "give": 3, "load": [3, 8, 10, 13], "defin": 3, "phi_atac": [3, 8, 10, 13], "region": 3, "loss": [3, 8], "l2": 3, "norm": 3, "reconstruct": 3, "error": [3, 8], "e": [3, 8, 13], "x_rna": 3, "wh_rna": 3, "_2": 3, "x_atac": 3, "wh_atac": 3, "float": 3, "loss_atac": 3, "just": [3, 8], "atac": [3, 8, 10, 13], "loss_rna": 3, "rna": [3, 8, 10, 13], "paramet": [3, 4], "The": [3, 13], "number": [3, 4, 8, 13], "latent": [3, 8], "inter": 3, "dure": 3, "optimis": 3, "default": 3, "string": 3, "method": [3, 7, 12, 13], "initialis": [3, 8, 13], "w": 3, "h": 3, "rel": 3, "weight": 3, "two": [3, 8], "modal": [3, 10], "between": 3, "1": [3, 10, 12], "includ": [3, 8], "l1": 3, "regularis": 3, "thi": [3, 4, 8], "todo": [3, 13], "us": [3, 10, 12, 13], "control": 3, "reproduc": 3, "when": 3, "initilis": 3, "fit": [3, 8, 10, 13], "rna_mat": [3, 8, 13], "atac_mat": [3, 8, 13], "acceler": 3, "hierarch": 3, "altern": 3, "least": 3, "squar": 3, "algorithm": 3, "propose": 3, "here": [3, 8, 13], "modifi": 3, "factoris": [3, 7, 8], "matric": [3, 12, 13], "http": [3, 8, 10, 13], "arxiv": 3, "org": 3, "pdf": 3, "1107": 3, "5194": 3, "onli": [3, 8, 13], "requir": [3, 4, 8, 10, 13], "argument": [3, 13], "ar": [3, 8, 10, 13], "gex": [3, 8, 10], "expect": 3, "featur": [3, 4, 8, 10], "format": [3, 8], "should": [3, 4], "scipi": [3, 8, 13], "spars": [3, 8, 13], "min": 3, "": [3, 8, 13], "t": [3, 8, 10], "so": [3, 13], "hold": [3, 8], "score": [3, 8], "And": 3, "phi": [3, 8], "allow": 3, "recontruct": [3, 8], "singl": [3, 7, 8, 13], "express": [3, 7, 8], "return": [3, 4, 8, 10], "access": [3, 7, 8], "dim": 3, "emb": 3, "self": 3, "mat_in": 4, "scale": 4, "10000": 4, "transform": [4, 8], "csr": 4, "posit": 4, "valu": [4, 10], "option": 4, "invalidmattyp": 4, "If": [4, 8, 10], "python": [7, 8, 13], "packag": [7, 8, 10, 13], "analysi": [7, 13], "exampl": [7, 12, 13], "found": 7, "10x": [7, 10, 12], "genom": [7, 8, 10], "It": [7, 13], "appli": 7, "non": 7, "neg": 7, "learn": [7, 13], "chromatin": [7, 8], "measur": 7, "same": [7, 8], "also": [7, 13], "plot": [7, 12], "enabl": 7, "biolog": 7, "interpret": 7, "result": 7, "offer": 7, "simpl": 7, "intuit": 7, "api": 7, "see": [7, 13], "refer": 7, "librari": 8, "int_nmf_model": 8, "must": 8, "directori": [8, 13], "can": [8, 13], "ad": [8, 10, 13], "path": [8, 10, 13], "10": [8, 10], "import": [8, 10, 13], "sc": [8, 10], "numpi": [8, 13], "np": 8, "from": [8, 10, 13], "script": 8, "log_tf_idf": [8, 10, 13], "matplotlib": [8, 13], "pyplot": 8, "plt": 8, "io": 8, "panda": [8, 10], "pd": [8, 10], "notebook": [8, 13], "some": 8, "what": 8, "do": 8, "how": [8, 13], "store": [8, 13], "three": 8, "differ": 8, "file": [8, 10, 13], "probabl": 8, "simplest": 8, "case": 8, "where": [8, 13], "readthedoc": 8, "en": 8, "latest": 8, "dataset": [8, 10], "recent": 8, "neurip": 8, "competit": 8, "add": [8, 13], "locat": 8, "11": 8, "atac_loc": 8, "openproblems_bmmc_multiome_phase2": 8, "censor_dataset": 8, "output_mod1": 8, "h5ad": [8, 10], "comp": 8, "multi": 8, "rna_loc": 8, "output_mod2": 8, "res_loc": 8, "output_solut": 8, "12": 8, "re": 8, "39": 8, "13": [8, 10], "read_h5ad": [8, 10], "14": [8, 10], "res_mat": 8, "n_ob": [8, 10], "n_var": [8, 10], "42492": 8, "13431": 8, "ob": [8, 10], "batch": 8, "cell_typ": 8, "pseudotime_order_gex": 8, "pseudotime_order_atac": 8, "var": [8, 10], "gene_id": [8, 10], "feature_typ": [8, 10], "un": 8, "dataset_id": 8, "organ": 8, "16": 8, "In": 8, "binari": 8, "real": 8, "ha": 8, "alreadi": 8, "been": 8, "preprocess": 8, "filter": 8, "befor": 8, "carri": 8, "out": [8, 13], "17": [8, 10], "atac_mat_tfidf_log": 8, "rna_mat_tfidf_log": 8, "model": [8, 10, 13], "minimis": 8, "wh": 8, "respect": 8, "18": 8, "nmf_model": [8, 10, 13], "20": 8, "activ": [8, 13], "each": 8, "shape": 8, "19": 8, "definit": 8, "which": 8, "facilit": 8, "g": 8, "print": [8, 10], "116490": 8, "These": 8, "have": [8, 13], "threshold": 8, "one": [8, 13], "improv": 8, "visualis": 8, "21": [8, 10], "imshow": 8, "aspect": 8, "interpol": 8, "cbar": 8, "colorbar": 8, "peak": 8, "22": [8, 10], "23": 8, "24": 8, "hist": 8, "ravel": 8, "8": [8, 10], "14293e": 8, "05": 8, "89050e": 8, "04": 8, "71900e": 8, "03": 8, "12200e": 8, "7": 8, "99000e": 8, "02": 8, "6": 8, "88000e": 8, "22000e": 8, "70000e": 8, "01": 8, "20000e": 8, "30000e": 8, "25888058e": 8, "00": 8, "51776115e": 8, "77664173e": 8, "03552231e": 8, "29440288e": 8, "55328346e": 8, "81216404e": 8, "00710446e": 8, "13299252e": 8, "lt": 8, "barcontain": 8, "artist": 8, "gt": 8, "first": [8, 13], "25": 8, "8342e": 8, "9830e": 8, "4": 8, "9800e": 8, "7700e": 8, "8300e": 8, "8400e": 8, "9600e": 8, "4500e": 8, "3000e": 8, "1000e": 8, "27215510e": 8, "27702815e": 8, "55405629e": 8, "83108444e": 8, "9": 8, "10811259e": 8, "13851407e": 8, "36621689e": 8, "59391970e": 8, "82162252e": 8, "04932533e": 8, "Or": 8, "contribut": 8, "26": 8, "5861e": 8, "9619e": 8, "0380e": 8, "5430e": 8, "1300e": 8, "3200e": 8, "2300e": 8, "4000e": 8, "2000e": 8, "0000e": 8, "91979667e": 8, "09246303e": 8, "01849261e": 8, "52773891e": 8, "03698521e": 8, "54623152e": 8, "05547782e": 8, "56472412e": 8, "07397042e": 8, "58321673e": 8, "chromtin": 8, "27": [8, 10], "2585e": 8, "5900e": 8, "5500e": 8, "7000e": 8, "07812024e": 8, "34391016e": 8, "68782032e": 8, "00317305e": 8, "33756406e": 8, "67195508e": 8, "00634610e": 8, "34073711e": 8, "67512813e": 8, "00951914e": 8, "over": 8, "time": 8, "28": 8, "fig": 8, "ax": 8, "subplot": 8, "cumsum": 8, "epoch_tim": 8, "line": 8, "line2d": 8, "0x7f8140541970": 8, "For": [8, 13], "ground": 8, "truth": 8, "label": [8, 10], "although": 8, "think": 8, "ve": 8, "got": 8, "version": 8, "without": [8, 10], "below": [8, 13], "an": 8, "umap": 8, "close": 8, "mirror": 8, "tutori": [8, 13], "pbmc3k": 8, "html": 8, "29": 8, "obsm": [8, 10, 13], "30": [8, 10], "size_factor": 8, "layer": 8, "count": 8, "31": 8, "pp": [8, 10], "neighbor": 8, "use_rep": 8, "n_pc": 8, "100": 8, "tl": 8, "leiden": 8, "32": 8, "max_top": 8, "argmax": 8, "axi": 8, "astyp": 8, "categori": 8, "33": 8, "pl": 8, "x_umap": 8, "color": 8, "34": 8, "rang": 8, "scatter": 8, "c": 8, "show": 8, "pca": 8, "35": 8, "svd_solver": 8, "arpack": 8, "n_neighbor": 8, "50": 8, "x_pca": 8, "key_ad": 8, "pca_nb": 8, "neighbors_kei": 8, "36": 8, "pbmc": [8, 10], "10k": 8, "sort": 8, "support": 8, "10xgenom": [8, 10], "com": [8, 10, 13], "softwar": 8, "pipelin": 8, "advanc": 8, "h5_matric": 8, "37": 8, "collect": 8, "sp_spars": 8, "tabl": 8, "countmatrix": 8, "namedtupl": 8, "feature_ref": 8, "barcod": 8, "abov": 8, "link": 8, "38": 8, "def": [8, 10], "get_matrix_from_h5": 8, "filenam": 8, "open_fil": 8, "r": 8, "f": 8, "mat_group": 8, "get_nod": 8, "root": 8, "read": [8, 10], "getattr": 8, "indic": 8, "indptr": 8, "csc_matrix": 8, "feature_group": 8, "feature_id": 8, "id": 8, "feature_nam": 8, "name": [8, 10, 13], "tag_kei": 8, "kei": 8, "decod": 8, "_all_tag_kei": 8, "filtered_matrix_h5": 8, "pbmc_granulocyte_sorted_10k_filtered_feature_bc_matrix": [8, 10], "h5": [8, 10], "filtered_feature_bc_matrix": 8, "40": 8, "b": 8, "ensg00000243485": 8, "ensg00000237613": 8, "ensg00000186092": 8, "ki270713": 8, "29624": 8, "30457": 8, "31340": 8, "32243": 8, "36927": 8, "37836": 8, "dtype": 8, "s26": 8, "mir1302": 8, "2hg": 8, "fam138a": 8, "or4f5": 8, "s15": 8, "grch38": 8, "s6": 8, "interv": [8, 10], "chr1": 8, "29553": 8, "30267": 8, "36080": 8, "36081": 8, "65418": 8, "69055": 8, "41": 8, "aaacagccaaggaatc": 8, "aaacagccaatccctt": 8, "aaacagccaatgcgct": 8, "tttgttggttgcagta": 8, "tttgttggttggttag": 8, "tttgttggtttgcaga": 8, "s18": 8, "42": 8, "180488x11898": 8, "int32": 8, "127525374": 8, "element": 8, "compress": 8, "column": 8, "43": 8, "multi_10x": 8, "44": 8, "ensg00000238009": 8, "al627309": 8, "120931": 8, "133723": 8, "ensg00000239945": 8, "91104": 8, "91105": 8, "180483": 8, "21434": 8, "22340": 8, "180484": 8, "26201": 8, "26826": 8, "180485": 8, "180486": 8, "180487": 8, "180488": 8, "row": 8, "45": 8, "rna_mat_10x": 8, "46": 8, "atac_mat_10x": 8, "47": 8, "11898": 8, "36601": [8, 10], "48": 8, "143887": 8, "read_10x_h5": [8, 10], "doe": 8, "appear": 8, "work": [8, 13], "49": 8, "h5_10x": 8, "variabl": [8, 10], "uniqu": [8, 10], "To": [8, 10, 13], "make": [8, 10], "them": [8, 10], "call": [8, 10], "var_names_make_uniqu": [8, 10], "ac141272": 8, "ensg00000277836": 8, "ac023491": 8, "ensg00000278633": 8, "ac007325": 8, "ensg00000276017": 8, "ensg00000278817": 8, "ensg00000277196": 8, "51": 8, "nmf_model_10x": 8, "52": 8, "0x7f806c063490": 8, "53": 8, "54": 8, "split": 8, "55": 8, "mat_dir": 8, "56": 8, "mmread": 8, "mtx": 8, "gz": 8, "57": 8, "read_csv": [8, 10], "tsv": [8, 10], "header": [8, 10], "sep": [8, 10], "chr": 8, "str": 8, "stop": 8, "58": 8, "int64": 8, "coordin": 8, "59": 8, "aaacagccacactaat": 8, "aaacagccaccaaccg": 8, "11893": 8, "tttgttggtgttaaac": 8, "11894": 8, "tttgttggttaggatt": 8, "11895": 8, "11896": 8, "11897": 8, "60": 8, "61": 8, "multi_10x_dir": 8, "srv": 8, "conda": [8, 13], "env": 8, "saturn": 8, "lib": 8, "python3": 8, "site": 8, "_core": 8, "py": 8, "120": 8, "implicitmodificationwarn": 8, "index": [8, 10], "warn": 8, "62": 8, "63": 8, "rna_dir": 8, "64": 8, "atac_dir": 8, "65": 8, "66": 8, "nmf_model_10x_dir": 8, "67": 8, "0x7f800e618790": 8, "68": 8, "69": 8, "annot": 10, "firstli": 10, "download": 10, "bash": [10, 13], "wget": 10, "check": 10, "certif": 10, "verbos": 10, "p": 10, "costalab": 10, "ukaachen": 10, "de": 10, "open_data": 10, "mojitoo": 10, "multiom_annot": 10, "cf": 10, "sampl": 10, "arc": 10, "pbmc_granulocyte_sorted_10k": 10, "muon": [10, 13], "mu": 10, "anndata": [10, 12, 13], "scanpi": [10, 12, 13], "o": [10, 13], "load_multiom": 10, "h5mu": 10, "_": 10, "extens": 10, "splitext": 10, "mu_data": 10, "elif": 10, "mudata": [10, 13], "updat": 10, "intersect_ob": 10, "remov": 10, "els": 10, "meta": 10, "index_col": 10, "filter_ob": 10, "11787": 10, "144978": 10, "x27": 10, "cluster": 10, "2": [10, 12], "108377": 10, "sy": [10, 13], "path_to_nmf": [10, 13], "scnmf": 10, "module_path": [10, 13], "abspath": [10, 13], "join": [10, 13], "append": [10, 13], "nmf_models_mod_upd": [10, 13], "rna_tf_idf": 10, "atac_tf_idf": 10, "k": 10, "varm": [10, 13], "introduct": 12, "multipl": 12, "old": 12, "view": 12, "histogram": 12, "individu": 12, "whole": 12, "hdf5": 12, "3": 12, "dir": 12, "sc_intnmf": 13, "git": 13, "clone": 13, "pip": 13, "command": 13, "desir": 13, "venv": 13, "github": 13, "wmorgan": 13, "quick_intnmf": 13, "scikit": 13, "ensur": 13, "virtual": 13, "environ": 13, "creat": 13, "int_nmf_env": 13, "path_to_quick_intnmf": 13, "txt": 13, "intnmf": 13, "other": 13, "your": 13, "you": 13, "train": 13, "both": 13, "recommend": 13, "follow": 13, "write": 13, "laod": 13, "section": 13, "jupyt": 13, "more": 13, "detail": 13}, "objects": {"": [[0, 0, 0, "-", "nmf_models"]], "nmf_models": [[1, 0, 0, "-", "nmf_models_mod_updates"], [5, 0, 0, "-", "plotting"]], "nmf_models.nmf_models_mod_updates": [[2, 1, 1, "", "InvalidMatType"], [3, 2, 1, "", "intNMF"], [4, 5, 1, "", "log_tf_idf"]], "nmf_models.nmf_models_mod_updates.intNMF": [[3, 3, 1, "", "fit"], [3, 4, 1, "", "loss"], [3, 4, 1, "", "loss_atac"], [3, 4, 1, "", "loss_rna"], [3, 4, 1, "", "phi_atac"], [3, 4, 1, "", "phi_rna"], [3, 4, 1, "", "theta"]]}, "objtypes": {"0": "py:module", "1": "py:exception", "2": "py:class", "3": "py:method", "4": "py:attribute", "5": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "exception", "Python exception"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"], "4": ["py", "attribute", "Python attribute"], "5": ["py", "function", "Python function"]}, "titleterms": {"nmf_model": [0, 1, 2, 3, 4, 5], "nmf_models_mod_upd": [1, 2, 3, 4], "invalidmattyp": 2, "intnmf": [3, 8, 10], "log_tf_idf": 4, "plot": [5, 8], "welcom": 7, "sc_intnmf": 7, "": 7, "document": 7, "content": 7, "exampl": [8, 10], "1": 8, "anndata": 8, "view": 8, "nmf": 8, "matric": 8, "histogram": 8, "individu": 8, "topic": 8, "whole": 8, "us": 8, "scanpi": 8, "method": 8, "2": 8, "10x": 8, "hdf5": 8, "data": 8, "3": 8, "dir": 8, "readm": 11, "tutori": 12, "usag": 13, "instal": 13, "basic": 13}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"nmf_models": [[0, "module-nmf_models"]], "nmf_models.nmf_models_mod_updates": [[1, "module-nmf_models.nmf_models_mod_updates"]], "nmf_models.nmf_models_mod_updates.InvalidMatType": [[2, "nmf-models-nmf-models-mod-updates-invalidmattype"]], "nmf_models.nmf_models_mod_updates.intNMF": [[3, "nmf-models-nmf-models-mod-updates-intnmf"]], "nmf_models.nmf_models_mod_updates.log_tf_idf": [[4, "nmf-models-nmf-models-mod-updates-log-tf-idf"]], "nmf_models.plotting": [[5, "module-nmf_models.plotting"]], "Welcome to sc_intNMF\u2019s documentation!": [[7, "welcome-to-sc-intnmf-s-documentation"]], "Contents": [[7, "contents"]], "intNMF examples": [[8, "intNMF-examples"]], "Example 1 - anndata": [[8, "Example-1---anndata"]], "Example plots to view the NMF matrices": [[8, "Example-plots-to-view-the-NMF-matrices"]], "Plots to view histograms of individual topics or whole matrices.": [[8, "Plots-to-view-histograms-of-individual-topics-or-whole-matrices."]], "Using Scanpys plotting methods": [[8, "Using-Scanpys-plotting-methods"]], "Example 2 - 10x HDF5 data": [[8, "Example-2---10x-HDF5-data"]], "Example 3 - 10x \u2018dir\u2019 data": [[8, "Example-3---10x-'dir'-data"]], "intNMF example": [[10, "intNMF-example"]], "README": [[11, "readme"]], "Tutorials": [[12, "tutorials"]], "Usage": [[13, "usage"]], "Installation": [[13, "installation"]], "Basic usage": [[13, "basic-usage"]]}, "indexentries": {"module": [[0, "module-nmf_models"], [1, "module-nmf_models.nmf_models_mod_updates"], [5, "module-nmf_models.plotting"]], "nmf_models": [[0, "module-nmf_models"]], "nmf_models.nmf_models_mod_updates": [[1, "module-nmf_models.nmf_models_mod_updates"]], "invalidmattype": [[2, "nmf_models.nmf_models_mod_updates.InvalidMatType"]], "fit() (intnmf method)": [[3, "nmf_models.nmf_models_mod_updates.intNMF.fit"]], "intnmf (class in nmf_models.nmf_models_mod_updates)": [[3, "nmf_models.nmf_models_mod_updates.intNMF"]], "loss (intnmf attribute)": [[3, "nmf_models.nmf_models_mod_updates.intNMF.loss"]], "loss_atac (intnmf attribute)": [[3, "nmf_models.nmf_models_mod_updates.intNMF.loss_atac"]], "loss_rna (intnmf attribute)": [[3, "nmf_models.nmf_models_mod_updates.intNMF.loss_rna"]], "phi_atac (intnmf attribute)": [[3, "nmf_models.nmf_models_mod_updates.intNMF.phi_atac"]], "phi_rna (intnmf attribute)": [[3, "nmf_models.nmf_models_mod_updates.intNMF.phi_rna"]], "theta (intnmf attribute)": [[3, "nmf_models.nmf_models_mod_updates.intNMF.theta"]], "log_tf_idf() (in module nmf_models.nmf_models_mod_updates)": [[4, "nmf_models.nmf_models_mod_updates.log_tf_idf"]], "nmf_models.plotting": [[5, "module-nmf_models.plotting"]]}})